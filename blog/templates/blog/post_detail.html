{% extends 'blog/base.html' %}
{% load semanticui %}
{% block content %}

<style>
    .post{
        width: 70%;
    }
</style>

<script>            
    $(document).ready(function() {
        $('.post-likes').click(function() {
            var id;
            id = $(this).attr('data-post-id');
            $.get('/like-blog/', {
                post_id: id
            }, function(data) {
                $('.like_count_blog').html(data);
            });
        });
    });
</script> 

<div class="ui container stackable grid">

    <div class="twelve wide column">
    
        <div class="ui raised very padded container segment">
            <div class="ui header">
                <a href="{% url 'post_detail' pk=post.pk %}">
                    <h2>{{ post.title }}</h2>
                </a>
            </div>
            <br/>
            {% if post.published_date %}
            <!--
                <div class="date">
                
                
                    <strong>{{ post.published_date|date:"Y-m-d H:i"}}</strong> by <strong>{{post.author}}</strong>  <a class="btn" href="{% url 'post_edit' pk=post.pk %}"><span class="glyphicon glyphicon-pencil"></span></a>
                -->    
                    
                    <div class="date-author" style="float:left;">
                        <div class="ui Teal label">时间
                            <div class="detail">{{ post.published_date|date:"Y-m-d"}}</div>
                        </div>
                        
                        <div class="ui Teal label">作者
                            <div class="detail">{{post.author}}</div>
                        </div>
                    </div>
                    
                    <div class="count" style="float:right">
                        <div class="ui Teal label">阅读
                            <div class="detail">{{post.click_number}}</div>
                        </div>
                
                        <div class="ui Teal label">评论
                            <div class="detail">{{post.comment_number}}</div>
                        </div>

 
          
                        <div class="ui teal label post-likes" id="heart-icon" data-post-id="{{ post.id }}">
                            <i class="tiny red like icon" id="heart-icon"></i>
                            <i class="like_count_blog" id="heart-counter">{{ post.likes }}</i>
                            {% if liked %}
           
                            {% else %}
                            
                            {% endif %}
                        </div>
   
                        
                        {% if user.is_authenticated %}                                      
                            <a href ="{% url 'post_edit' pk=post.pk %}">
                                <button class="small teal ui icon right floated label">
                                <i class="write icon"></i>
                            </a>
                        {% else %}
                        
                        {% endif %}
                    </div> 
                    
            {% endif %}
            <br/>
            <div class="ui clearing divider"></div>
            <br /> 
            <p>{{ post.text|linebreaksbr }}</p>            
            <br />
            
            <div class="likes">
                <button class="tiny ui teal button post-likes" id="heart-icon" data-post-id="{{ post.id }}">
                    <i class="red like icon" id="heart-icon"></i>
                    <i class="like_count_blog" id="heart-counter">{{ post.likes }}</i>
                    {% if liked %}               
                    {% else %}                                
                    {% endif %}
                </button> 
            </div>

            <div class="share-to" style="float:right;">
            

                
                <button class="tiny ui teal right labeled icon button">
                    <i class="share icon"></i>
                        分享到
                </button>
            
                <button class="tiny ui circular Green wechat icon button">
                    <i class="wechat icon"></i>
                </button>
                
                <button class="tiny ui circular Red weibo icon button">
                    <i class="weibo icon"></i>
                </button>
                
                <button class="tiny ui circular blue qq icon button">
                    <i class="qq icon"></i>
                </button>                  
            </div>         
           
            <div class="ui clearing divider"></div>
                
            <br/>
            <div class="page-num">
                {% include "blog/pagination.html" with page=posts %}
            </div> 
            <br/>
        </div>
        
        <div class="ui raised very padded container segment">        
            <div class="ui comments">
                <div class="ui top attached tabular menu">
                    <div class="active item">文章评论</div>
                </div>
        <!--        <h3 class="ui dividing header">文章评论</h3>    -->
        
                {% for comment in comments %}
                    <div class="comment">
                        <div class="content">                    
                            <a class="author">{{ comment.name }}</a>
                            
                            <div class="metadata">
                                <span class="date">{{comment.created|date:"Y-m-d H:i"}}</span>
                            </div>
                            
                            <div class="text">
                                <p>{{ comment.content }}</p>
                            </div>
                            
                            <div class="actions">
                                <a class="reply">回复</a>
                            </div>

                            <div class="ui clearing divider"></div>
                        </div>
                    </div>               
                    {% empty %}
                    <br/>
                    <br/>
                    <p>暂无评论</p>
                {% endfor %}
            </div>
        </div>
        
        <div class="ui raised very padded container segment">
            <div class="ui top attached tabular menu">
                <div class="active item">添加评论</div>
            </div>
            <br/>
            <br/>                
            <form class="ui form" method="post">
                {% csrf_token %}
                {{ form|semanticui }}
                <button class="ui primary submit labeled icon button" type="submit">
                    <i class="icon edit"></i>提交</button>
            </form>        
        </div>
        
    </div>


     
    <div class="four wide column">
	    <div class="ui raised very padded container segment">
            <p>{{ post.text|linebreaksbr }}</p>  
        </div>
    </div>
</div>
          
{% endblock %}
